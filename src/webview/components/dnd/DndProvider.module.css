/**
 * DndProvider.module.css - Drag and Drop styling
 * Includes drag states, drop zone highlighting, invalid drop indicators
 */

/* ============================================================================
 * DnD Container
 * ============================================================================ */

.dndContainer {
  position: relative;
  width: 100%;
  height: 100%;
}

.dndContainer.isDragging {
  cursor: grabbing;
  user-select: none;
}

.dndContainer.validDrop {
  /* Global valid drop state */
}

.dndContainer.invalidDrop {
  /* Global invalid drop state */
}

/* ============================================================================
 * Screen Reader Only
 * ============================================================================ */

.srOnly {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* ============================================================================
 * Draggable Base Styles
 * ============================================================================ */

.draggable {
  position: relative;
  cursor: grab;
  touch-action: none;
  transition:
    transform var(--animation-fast) ease,
    opacity var(--animation-fast) ease,
    box-shadow var(--animation-fast) ease;
}

.draggable:hover:not(.disabled) {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.draggable:focus-visible {
  outline: 2px solid var(--vscode-focusBorder);
  outline-offset: 2px;
}

.draggable.dragging {
  cursor: grabbing;
  opacity: 0.5;
  z-index: 1000;
}

.draggable.disabled {
  cursor: not-allowed;
  opacity: 0.5;
}

/* ============================================================================
 * Draggable Commit
 * ============================================================================ */

.draggableCommit {
  border-radius: var(--radius-medium);
  background-color: var(--vscode-editor-background);
}

.draggableCommit:hover:not(.disabled):not(.dragging) {
  background-color: var(--vscode-list-hoverBackground);
}

.draggableCommit.dragging {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
}

/* ============================================================================
 * Draggable Commit Group
 * ============================================================================ */

.draggableCommitGroup {
  position: relative;
}

.dragBadge {
  position: absolute;
  top: -8px;
  right: -8px;
  min-width: 20px;
  height: 20px;
  padding: 0 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: var(--vscode-badge-background);
  color: var(--vscode-badge-foreground);
  font-size: var(--font-size-xs);
  font-weight: 600;
  border-radius: 10px;
  z-index: 1;
}

/* ============================================================================
 * Draggable Branch
 * ============================================================================ */

.draggableBranch {
  display: inline-flex;
  align-items: center;
  gap: var(--spacing-xs);
  padding: var(--spacing-xs) var(--spacing-sm);
  border-radius: var(--radius-small);
  background-color: var(--vscode-editor-background);
  border: 1px solid var(--vscode-widget-border);
}

.draggableBranch:hover:not(.disabled):not(.dragging) {
  border-color: var(--vscode-focusBorder);
}

/* ============================================================================
 * Droppable Base Styles
 * ============================================================================ */

.droppable {
  position: relative;
  transition:
    background-color var(--animation-fast) ease,
    border-color var(--animation-fast) ease,
    box-shadow var(--animation-fast) ease;
}

.droppable.disabled {
  opacity: 0.5;
  pointer-events: none;
}

/* ============================================================================
 * Droppable Branch
 * ============================================================================ */

.droppableBranch {
  position: relative;
  border-radius: var(--radius-medium);
  border: 2px dashed transparent;
}

.droppableBranch.dropTargetActive {
  border-color: var(--vscode-focusBorder);
}

.droppableBranch.dropTargetValid {
  border-color: var(--success-green);
  background-color: rgba(76, 175, 80, 0.1);
}

.droppableBranch.dropTargetInvalid {
  border-color: var(--error-red);
  background-color: rgba(244, 67, 54, 0.1);
}

/* ============================================================================
 * Drop Indicator
 * ============================================================================ */

.dropIndicator {
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
  padding: var(--spacing-xs) var(--spacing-sm);
  margin-top: var(--spacing-xs);
  background-color: var(--vscode-editorWidget-background);
  border: 1px solid var(--vscode-widget-border);
  border-radius: var(--radius-small);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  white-space: nowrap;
  z-index: 100;
}

.dropIndicatorIcon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
}

.dropIndicatorText {
  font-size: var(--font-size-sm);
  color: var(--vscode-foreground);
}

/* ============================================================================
 * Drop Highlight Overlay
 * ============================================================================ */

.dropHighlight {
  position: absolute;
  inset: 0;
  background-color: rgba(76, 175, 80, 0.15);
  border-radius: inherit;
  pointer-events: none;
  animation: pulseHighlight 1.5s ease-in-out infinite;
}

@keyframes pulseHighlight {
  0%, 100% {
    opacity: 0.5;
  }
  50% {
    opacity: 1;
  }
}

/* ============================================================================
 * Drop Zone
 * ============================================================================ */

.dropZone {
  position: relative;
  min-height: 40px;
  border-radius: var(--radius-medium);
  border: 2px dashed var(--vscode-widget-border);
  transition: all var(--animation-fast) ease;
}

.dropZone--empty-space {
  min-height: 60px;
  background-color: transparent;
}

.dropZone--position {
  min-height: 20px;
  min-width: 100%;
  margin: var(--spacing-xs) 0;
}

.dropZone--commit {
  border-style: solid;
}

.dropZone--branch {
  border-style: dashed;
}

/* Drop Zone States */
.dropZone--idle {
  border-color: transparent;
}

.dropZone--potential {
  border-color: var(--vscode-widget-border);
  background-color: rgba(128, 128, 128, 0.05);
}

.dropZone--hover {
  border-color: var(--vscode-focusBorder);
  background-color: rgba(128, 128, 128, 0.1);
}

.dropZone--accept {
  border-color: var(--success-green);
  background-color: rgba(76, 175, 80, 0.15);
}

.dropZone--reject {
  border-color: var(--error-red);
  background-color: rgba(244, 67, 54, 0.1);
}

/* Drop Zone Content */
.dropZoneContent {
  position: relative;
  z-index: 1;
}

.dropZoneEmpty {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: inherit;
  color: var(--vscode-descriptionForeground);
  font-size: var(--font-size-sm);
}

.dropZoneHoverContent {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: rgba(0, 0, 0, 0.7);
  color: white;
  z-index: 10;
}

.dropZoneFeedback {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  margin-bottom: var(--spacing-xs);
  z-index: 100;
}

/* Drop Zone Border */
.dropZoneBorder {
  position: absolute;
  inset: -2px;
  border-radius: inherit;
  border: 2px solid transparent;
  pointer-events: none;
  transition: border-color var(--animation-fast) ease;
}

.dropZoneBorder.borderAccept {
  border-color: var(--success-green);
  box-shadow: 0 0 8px var(--success-green);
}

.dropZoneBorder.borderReject {
  border-color: var(--error-red);
}

.dropZoneBorder.borderPotential {
  border-color: var(--vscode-focusBorder);
  border-style: dashed;
}

/* ============================================================================
 * Feedback Indicator
 * ============================================================================ */

.feedbackIndicator {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
  padding: var(--spacing-xs) var(--spacing-sm);
  background-color: var(--vscode-editorWidget-background);
  border: 1px solid var(--vscode-widget-border);
  border-radius: var(--radius-small);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  font-size: var(--font-size-sm);
}

.feedback--accept {
  border-color: var(--success-green);
  color: var(--success-green);
}

.feedback--reject {
  border-color: var(--error-red);
  color: var(--error-red);
}

.feedback--hover {
  border-color: var(--vscode-focusBorder);
}

.feedbackIcon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
}

.feedbackMessage {
  white-space: nowrap;
}

.feedbackOperation {
  padding: 2px 6px;
  background-color: rgba(128, 128, 128, 0.2);
  border-radius: var(--radius-small);
  font-size: var(--font-size-xs);
  text-transform: capitalize;
}

/* ============================================================================
 * Empty Space Drop Zone
 * ============================================================================ */

.emptySpaceDropZone {
  position: absolute;
  border-radius: var(--radius-large);
  opacity: 0;
  transition: opacity var(--animation-fast) ease;
}

.dndContainer.isDragging .emptySpaceDropZone {
  opacity: 1;
}

.emptySpacePlaceholder {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: var(--vscode-descriptionForeground);
  font-size: var(--font-size-sm);
  font-style: italic;
}

/* ============================================================================
 * Position Drop Zone (for reordering)
 * ============================================================================ */

.positionDropZone {
  height: 4px;
  min-height: 4px;
  margin: 2px 0;
  border-radius: 2px;
  transition: all var(--animation-fast) ease;
}

.positionDropZone.dropZone--hover,
.positionDropZone.dropZone--accept {
  height: 8px;
  min-height: 8px;
}

/* ============================================================================
 * Drag Overlay
 * ============================================================================ */

.dragOverlay {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm);
  padding: var(--spacing-sm);
  background-color: var(--vscode-editorWidget-background);
  border: 1px solid var(--vscode-widget-border);
  border-radius: var(--radius-medium);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
  cursor: grabbing;
  min-width: 200px;
  max-width: 300px;
}

.dragOverlay.dragOverlayValid {
  border-color: var(--success-green);
}

.dragOverlay.dragOverlayInvalid {
  border-color: var(--error-red);
}

.dragOverlaySource {
  /* Source content styling */
}

.dragOverlayOperation {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
  padding: var(--spacing-xs) var(--spacing-sm);
  border-radius: var(--radius-small);
  font-size: var(--font-size-sm);
  font-weight: 500;
}

.dragOverlayOperation.operationValid {
  background-color: rgba(76, 175, 80, 0.15);
  color: var(--success-green);
}

.dragOverlayOperation.operationInvalid {
  background-color: rgba(244, 67, 54, 0.15);
  color: var(--error-red);
}

.operationIcon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
}

.operationLabel {
  text-transform: capitalize;
}

.dragOverlayHint {
  font-size: var(--font-size-sm);
  color: var(--vscode-descriptionForeground);
  font-style: italic;
}

/* ============================================================================
 * Commit Preview (in drag overlay)
 * ============================================================================ */

.commitPreview {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xs);
}

.commitPreviewHeader {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.commitHash {
  font-family: var(--vscode-editor-font-family);
  font-size: var(--font-size-sm);
  color: var(--info-blue);
  font-weight: 600;
}

.commitBranch {
  font-size: var(--font-size-xs);
  color: var(--vscode-descriptionForeground);
  padding: 2px 6px;
  background-color: rgba(128, 128, 128, 0.15);
  border-radius: var(--radius-small);
}

.commitMessage {
  font-size: var(--font-size-sm);
  color: var(--vscode-foreground);
  line-height: 1.4;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.commitMeta {
  font-size: var(--font-size-xs);
  color: var(--vscode-descriptionForeground);
}

.commitAuthor {
  font-weight: 500;
}

/* ============================================================================
 * Branch Preview (in drag overlay)
 * ============================================================================ */

.branchPreview {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
}

.branchIcon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  color: var(--branch-feature);
}

.branchName {
  font-family: var(--vscode-editor-font-family);
  font-size: var(--font-size-sm);
  font-weight: 500;
}

.remoteBadge {
  font-size: var(--font-size-xs);
  padding: 2px 6px;
  background-color: rgba(255, 152, 0, 0.15);
  color: var(--branch-release);
  border-radius: var(--radius-small);
}

/* ============================================================================
 * Branch Pointer Preview
 * ============================================================================ */

.branchPointerPreview {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
}

.pointerArrow {
  color: var(--vscode-descriptionForeground);
  font-family: var(--vscode-editor-font-family);
}

/* ============================================================================
 * Tag Preview
 * ============================================================================ */

.tagPreview {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
}

.tagIcon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  color: var(--branch-release);
}

.tagName {
  font-family: var(--vscode-editor-font-family);
  font-size: var(--font-size-sm);
  font-weight: 500;
  color: var(--branch-release);
}

/* ============================================================================
 * Operation Preview Modal
 * ============================================================================ */

.operationPreviewOverlay {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: rgba(0, 0, 0, 0.6);
  z-index: 10000;
  animation: fadeIn var(--animation-fast) ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.operationPreviewModal {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-lg);
  width: 90%;
  max-width: 600px;
  max-height: 90vh;
  padding: var(--spacing-lg);
  background-color: var(--vscode-editor-background);
  border: 1px solid var(--vscode-widget-border);
  border-radius: var(--radius-large);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  animation: slideUp var(--animation-normal) ease;
  overflow-y: auto;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Preview Header */
.previewHeader {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.previewTitle {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  margin: 0;
  font-size: var(--font-size-xl);
  font-weight: 600;
  color: var(--vscode-foreground);
}

.operationTypeIcon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  color: var(--info-blue);
}

.previewCloseButton {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  padding: 0;
  background: none;
  border: none;
  border-radius: var(--radius-small);
  cursor: pointer;
  color: var(--vscode-foreground);
  transition: background-color var(--animation-fast) ease;
}

.previewCloseButton:hover:not(:disabled) {
  background-color: var(--vscode-toolbar-hoverBackground);
}

.previewCloseButton:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Preview Description */
.previewDescription {
  font-size: var(--font-size-md);
  color: var(--vscode-foreground);
  line-height: 1.5;
}

.previewDescription p {
  margin: 0;
}

/* Preview Warning */
.previewWarning {
  display: flex;
  align-items: flex-start;
  gap: var(--spacing-sm);
  padding: var(--spacing-md);
  background-color: rgba(255, 193, 7, 0.1);
  border: 1px solid var(--warning-yellow);
  border-radius: var(--radius-medium);
  font-size: var(--font-size-sm);
  color: var(--vscode-foreground);
}

.previewWarning.warningDanger {
  background-color: rgba(244, 67, 54, 0.1);
  border-color: var(--error-red);
}

.previewWarning svg {
  flex-shrink: 0;
  width: 16px;
  height: 16px;
  color: var(--warning-yellow);
}

.previewWarning.warningDanger svg {
  color: var(--error-red);
}

/* Preview Visualization */
.previewVisualization {
  display: flex;
  align-items: stretch;
  gap: var(--spacing-md);
}

.visualizationPane {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm);
  padding: var(--spacing-md);
  background-color: var(--vscode-editor-inactiveSelectionBackground);
  border-radius: var(--radius-medium);
}

.visualizationTitle {
  margin: 0;
  font-size: var(--font-size-sm);
  font-weight: 600;
  color: var(--vscode-descriptionForeground);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.visualizationContent {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 80px;
}

.visualizationArrow {
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--vscode-descriptionForeground);
}

/* Mini Graph */
.miniGraph {
  width: 100%;
  height: auto;
}

.graphPreview {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
}

.previewPlaceholder {
  font-size: var(--font-size-sm);
  color: var(--vscode-descriptionForeground);
  font-style: italic;
}

/* Preview Command */
.previewCommand {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-md);
  background-color: var(--vscode-textCodeBlock-background);
  border-radius: var(--radius-medium);
  overflow-x: auto;
}

.commandLabel {
  font-size: var(--font-size-sm);
  color: var(--vscode-descriptionForeground);
  white-space: nowrap;
}

.commandCode {
  font-family: var(--vscode-editor-font-family);
  font-size: var(--font-size-sm);
  color: var(--vscode-textPreformat-foreground);
}

/* Preview Actions */
.previewActions {
  display: flex;
  justify-content: flex-end;
  gap: var(--spacing-sm);
  padding-top: var(--spacing-md);
  border-top: 1px solid var(--vscode-widget-border);
}

.cancelButton,
.confirmButton {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-xs);
  padding: var(--spacing-sm) var(--spacing-lg);
  border: none;
  border-radius: var(--radius-small);
  font-size: var(--font-size-md);
  font-weight: 500;
  cursor: pointer;
  transition:
    background-color var(--animation-fast) ease,
    opacity var(--animation-fast) ease;
}

.cancelButton {
  background-color: var(--vscode-button-secondaryBackground);
  color: var(--vscode-button-secondaryForeground);
}

.cancelButton:hover:not(:disabled) {
  background-color: var(--vscode-button-secondaryHoverBackground);
}

.confirmButton {
  background-color: var(--vscode-button-background);
  color: var(--vscode-button-foreground);
}

.confirmButton:hover:not(:disabled) {
  background-color: var(--vscode-button-hoverBackground);
}

.confirmButton.confirmDanger {
  background-color: var(--error-red);
}

.confirmButton.confirmDanger:hover:not(:disabled) {
  background-color: #d32f2f;
}

.cancelButton:disabled,
.confirmButton:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Loading Spinner */
.spinner {
  animation: spin 1s linear infinite;
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

/* ============================================================================
 * Reduced Motion
 * ============================================================================ */

@media (prefers-reduced-motion: reduce) {
  .draggable,
  .droppable,
  .dropZone,
  .dropHighlight,
  .operationPreviewOverlay,
  .operationPreviewModal,
  .feedbackIndicator,
  .dragOverlay,
  .spinner {
    transition: none;
    animation: none;
  }

  .dropHighlight {
    opacity: 0.75;
  }
}
